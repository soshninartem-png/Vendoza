{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.title }}</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --blue: #2563eb;
            --blue-hover: #1d4ed8;
            --blue-light: #eff6ff;
            --blue-badge: #dbeafe;
            --yellow: #fbbf24;
            --text: #111827;
            --text-muted: #6b7280;
            --border: #e5e7eb;
            --bg: #f9fafb;
            --white: #ffffff;
            --success: #10b981;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1320px;
            margin: 0 auto;
            padding: 24px;
        }

        /* BREADCRUMBS */
        .breadcrumbs {
            display: flex;
            gap: 8px;
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .breadcrumbs a {
            color: var(--text-muted);
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumbs a:hover {
            color: var(--blue);
        }

        /* MAIN LAYOUT - 3 —Ä–∞–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ */
        .product-layout {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        /* –í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –≤—ã—Å–æ—Ç–æ–π */
        .card {
            background: var(--white);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            transform: translateY(-4px);
        }

        /* IMAGE CARD */
        .image-card {
            position: relative;
        }

        .image-container {
            width: 100%;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg);
            border-radius: 12px;
            overflow: hidden;
        }

        .product-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: transform 0.5s ease;
        }

        .image-container:hover .product-image {
            transform: scale(1.05);
        }

        .badge-sale {
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 8px 16px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
            z-index: 1;
        }

        /* INFO CARD */
        .info-card {
            display: flex;
            flex-direction: column;
        }

        .rating-section {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .stars {
            color: var(--yellow);
            font-size: 16px;
            letter-spacing: 2px;
        }

        .rating-text {
            color: var(--text);
            font-weight: 700;
            font-size: 15px;
        }

        .rating-link {
            color: var(--blue);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
        }

        .rating-link:hover {
            text-decoration: underline;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text);
        }

        .description-text {
            color: #374151;
            line-height: 1.7;
            font-size: 14px;
            flex: 1;
        }

        /* PRICE CARD */
        .price-card-wrapper {
            display: flex;
            flex-direction: column;
        }

        .price-section {
            margin-bottom: 20px;
        }

        .price-current {
            font-size: 36px;
            font-weight: 800;
            color: var(--blue);
            line-height: 1;
            letter-spacing: -0.02em;
        }

        .price-old {
            font-size: 16px;
            color: var(--text-muted);
            text-decoration: line-through;
            margin-top: 6px;
        }

        .installment-card {
            background: linear-gradient(135deg, var(--blue-light) 0%, var(--blue-badge) 100%);
            border-radius: 14px;
            padding: 18px;
            margin-bottom: 16px;
            border: 1px solid #bfdbfe;
        }

        .installment-tabs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
            margin-bottom: 14px;
        }

        .tab {
            padding: 10px 6px;
            border: none;
            background: rgba(255,255,255,0.6);
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            color: var(--text-muted);
        }

        .tab:hover {
            background: rgba(255,255,255,0.8);
        }

        .tab.active {
            background: white;
            color: var(--blue);
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.2);
            transform: translateY(-1px);
        }

        .installment-info {
            text-align: center;
        }

        .installment-price {
            font-size: 26px;
            font-weight: 800;
            color: var(--blue);
        }

        .installment-term {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--blue);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            width: 100%;
            margin-bottom: 12px;
        }

        .btn-primary:hover {
            background: var(--blue-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(37, 99, 235, 0.4);
        }

        .btn-primary.added {
            background: var(--success);
        }

        .btn-wishlist {
            background: white;
            border: 2px solid var(--border);
            width: 48px;
            height: 48px;
            padding: 0;
            font-size: 20px;
        }

        .btn-wishlist:hover {
            border-color: var(--blue);
            color: var(--blue);
        }

        .btn-wishlist.active {
            border-color: var(--blue);
            color: var(--blue);
            background: var(--blue-light);
        }

        /* Delivery Options */
        .delivery-options {
            margin-bottom: 16px;
        }

        .delivery-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 8px;
        }

        .delivery-option:hover {
            border-color: var(--blue);
            background: var(--blue-light);
        }

        .delivery-option.active {
            border-color: var(--blue);
            background: var(--blue-light);
        }

        .delivery-radio {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .delivery-option.active .delivery-radio {
            border-color: var(--blue);
        }

        .delivery-radio::after {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--blue);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .delivery-option.active .delivery-radio::after {
            opacity: 1;
        }

        .delivery-info {
            flex: 1;
        }

        .delivery-title {
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
        }

        .delivery-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        .delivery-price {
            font-weight: 700;
            font-size: 15px;
            color: var(--blue);
        }

        /* Info boxes */
        .info-box {
            padding: 12px;
            background: var(--bg);
            border-radius: 10px;
            margin-bottom: 12px;
            font-size: 13px;
            border: 1px solid var(--border);
        }

        .info-box-title {
            font-weight: 700;
            color: var(--text);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .info-box-text {
            color: var(--text-muted);
        }

        /* Total Price */
        .total-price {
            padding: 14px;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 10px;
            margin-bottom: 16px;
            border: 1px solid #fcd34d;
        }

        .total-label {
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .total-amount {
            font-size: 28px;
            font-weight: 800;
            color: var(--text);
        }

        /* FULL WIDTH SECTIONS */
        .full-width-section {
            background: var(--white);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
        }

        .section-header {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
        }

        /* REVIEWS */
        .review-card {
            border-bottom: 1px solid var(--border);
            padding: 16px 0;
            transition: all 0.2s;
        }

        .review-card:hover {
            background: var(--bg);
            padding: 16px;
            margin: 0 -16px;
            border-radius: 12px;
        }

        .review-card:last-child {
            border-bottom: none;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .reviewer-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .review-date {
            color: var(--text-muted);
            font-size: 12px;
        }

        .review-text {
            color: #374151;
            line-height: 1.6;
            font-size: 13px;
        }

        /* COMMENT FORM */
        .comment-form {
            background: var(--bg);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border: 1px solid var(--border);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 8px;
            color: var(--text);
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--blue);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .rating-input {
            display: flex;
            gap: 8px;
            font-size: 28px;
        }

        .star-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #d1d5db;
            transition: all 0.2s;
            padding: 0;
        }

        .star-btn:hover,
        .star-btn.active {
            color: var(--yellow);
            transform: scale(1.1);
        }

        .btn-submit {
            background: var(--blue);
            color: white;
            padding: 12px 32px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-submit:hover {
            background: var(--blue-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        /* RESPONSIVE */
        @media (max-width: 1024px) {
            .product-layout {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }

            .installment-tabs {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- BREADCRUMBS -->
    <div class="breadcrumbs">
        <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
        <span>‚Ä∫</span>
        <a href="#">{{ product.category }}</a>
        <span>‚Ä∫</span>
        <span>{{ product.title }}</span>
    </div>

    <!-- MAIN PRODUCT LAYOUT - 3 —Ä–∞–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ -->
    <div class="product-layout">

        <!-- COLUMN 1: IMAGE -->
        <div class="card image-card">
            {% if product.old_price %}
            <div class="badge-sale">-{{ product.discount_percent|default:"0" }}%</div>
            {% endif %}
            <div class="image-container">
                <img src="{{ product.image.url }}" alt="{{ product.title }}" class="product-image">
            </div>
        </div>

        <!-- COLUMN 2: INFO -->
        <div class="card info-card">
            <div class="rating-section">
                <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                <span class="rating-text">{{ product.rating|default:"4.7" }}</span>
                <a href="#reviews" class="rating-link">{{ product.review_count|default:"0" }} –æ—Ç–∑—ã–≤–æ–≤</a>
            </div>

            <h2 class="section-title">–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h2>
            <div class="description-text">
                {{ product.description|default:"500g" }}
            </div>
        </div>

        <!-- COLUMN 3: PRICE & ACTIONS -->
        <div class="card price-card-wrapper">
            <div class="price-section">
                <div class="price-current" id="basePrice">{{ product.price|floatformat:0 }} $</div>
                {% if product.old_price %}
                <div class="price-old">{{ product.old_price|floatformat:0 }} $</div>
                {% endif %}
            </div>

            <div class="installment-card">
                <div class="installment-tabs">
                    <button class="tab" data-months="3">3 –º–µ—Å</button>
                    <button class="tab" data-months="6">6 –º–µ—Å</button>
                    <button class="tab" data-months="12">12 –º–µ—Å</button>
                    <button class="tab active" data-months="24">24 –º–µ—Å</button>
                </div>
                <div class="installment-info">
                    <div class="installment-price" id="monthlyPrice">0 $</div>
                    <div class="installment-term" id="monthlyTerm">√ó 24 –º–µ—Å</div>
                </div>
            </div>

            <!-- DELIVERY OPTIONS -->
            <div class="delivery-options">
                <div class="delivery-option active" data-price="0">
                    <div class="delivery-radio"></div>
                    <div class="delivery-info">
                        <div class="delivery-title">–°–∞–º–æ–≤—ã–≤–æ–∑</div>
                        <div class="delivery-desc">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
                    </div>
                    <div class="delivery-price">0 $</div>
                </div>
                <div class="delivery-option" data-price="10">
                    <div class="delivery-radio"></div>
                    <div class="delivery-info">
                        <div class="delivery-title">üöö –î–æ—Å—Ç–∞–≤–∫–∞</div>
                        <div class="delivery-desc">1-3 –¥–Ω—è –ø–æ –≥–æ—Ä–æ–¥—É</div>
                    </div>
                    <div class="delivery-price">+10 $</div>
                </div>
            </div>

            <!-- TOTAL PRICE -->
            <div class="total-price">
                <div class="total-label">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</div>
                <div class="total-amount" id="totalPrice">{{ product.price|floatformat:0 }} $</div>
            </div>

            <!-- ACTION BUTTONS -->
            <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                <div class="col">
              <form method="post" action="{% url 'shop:cart' %}">
                {% csrf_token %}
                <input type="hidden" name="product_id" value="{{ product.id }}">
                <button type="submit"
                        class="btn btn-primary rounded-1 p-2 fs-7 w-100">
                  <svg width="18" height="18">
                    <use xlink:href="#cart"></use>
                  </svg>
                  Add to Cart
                </button>
              </form>
            </div>
                  <div class="col-2">
              <form method="post" action="{% url 'shop:wishlist' %}">
                {% csrf_token %}
                <input type="hidden" name="product_id" value="{{ product.id }}">
                <button type="submit"
                        class="btn btn-outline-dark rounded-1 p-2 fs-6">
                  <svg width="0.25" height="0.25">
                    <img src="https://icon.boxicons.com/3.0.7/4x/basic/rounded/200/bx-heart.webp" alt="">
                  </svg>
                </button>
              </form>
            </div>

            </div>

            <!-- PAYMENT INFO -->
            <div class="info-box">
                <div class="info-box-title">
                    <span>üíµ</span>
                    <span>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</span>
                </div>
                <div class="info-box-text">–¢–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</div>
            </div>
        </div>

    </div>

    <!-- REVIEWS SECTION -->
    <div class="full-width-section" id="reviews">
        <h2 class="section-header">–û—Ç–∑—ã–≤—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</h2>

        <div id="reviewsList">
            {% if product.reviews.all %}
                {% for review in product.reviews.all %}
                <div class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="reviewer-name">{{ review.user_name }}</div>
                            <div class="stars" style="font-size: 14px;">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= review.rating %}‚òÖ{% else %}‚òÜ{% endif %}
                                {% endfor %}
                            </div>
                        </div>
                        <div class="review-date">{{ review.created_at|date:"d E" }}</div>
                    </div>
                    <div class="review-text">{{ review.comment }}</div>
                </div>
                {% endfor %}
            {% else %}
                <p style="color: var(--text-muted); text-align: center; padding: 20px;">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
            {% endif %}
        </div>

        <!-- COMMENT FORM -->
        <div class="comment-form">
            <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
            <form id="reviewForm">
                <div class="form-group">
                    <label class="form-label">–í–∞—à–µ –∏–º—è</label>
                    <input type="text" class="form-input" id="userName" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                </div>

                <div class="form-group">
                    <label class="form-label">–û—Ü–µ–Ω–∫–∞</label>
                    <div class="rating-input" id="ratingInput">
                        <button type="button" class="star-btn" data-rating="1">‚òÖ</button>
                        <button type="button" class="star-btn" data-rating="2">‚òÖ</button>
                        <button type="button" class="star-btn" data-rating="3">‚òÖ</button>
                        <button type="button" class="star-btn" data-rating="4">‚òÖ</button>
                        <button type="button" class="star-btn" data-rating="5">‚òÖ</button>
                    </div>
                    <input type="hidden" id="ratingValue" value="5" required>
                </div>

                <div class="form-group">
                    <label class="form-label">–í–∞—à –æ—Ç–∑—ã–≤</label>
                    <textarea class="form-textarea" id="reviewText" required placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–µ–º –æ–ø—ã—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞"></textarea>
                </div>

                <button type="submit" class="btn-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
            </form>
        </div>
    </div>

</div>

<script>
    // Product data
    const productData = {
        id: {{ product.id|default:0 }},
        title: "{{ product.title|escapejs }}",
        price: {{ product.price|default:0 }},
        image: "{{ product.image.url|default:'' }}"
    };

    let basePrice = productData.price;
    let deliveryPrice = 0;

    // ============================================
    // DELIVERY OPTIONS
    // ============================================
    
    const deliveryOptions = document.querySelectorAll('.delivery-option');
    const totalPriceEl = document.getElementById('totalPrice');
    
    deliveryOptions.forEach(option => {
        option.addEventListener('click', function() {
            deliveryOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            deliveryPrice = parseFloat(this.dataset.price);
            updateTotalPrice();
        });
    });

    function updateTotalPrice() {
        const total = basePrice + deliveryPrice;
        totalPriceEl.textContent = Math.ceil(total) + ' $';
    }

    // ============================================
    // INSTALLMENT CALCULATOR
    // ============================================
    
    const tabs = document.querySelectorAll('.tab');
    const monthlyPrice = document.getElementById('monthlyPrice');
    const monthlyTerm = document.getElementById('monthlyTerm');

    function updateInstallment(months) {
        const monthly = Math.ceil(basePrice / months);
        monthlyPrice.textContent = monthly + ' $';
        monthlyTerm.textContent = '√ó ' + months + ' –º–µ—Å';
    }

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            const months = parseInt(tab.dataset.months);
            updateInstallment(months);
        });
    });

    updateInstallment(24);

    // ============================================
    // CART FUNCTIONALITY
    // ============================================
    
    function getCart() {
        const cart = localStorage.getItem('cart');
        return cart ? JSON.parse(cart) : [];
    }

    function saveCart(cart) {
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    function addToCart(product, delivery) {
        let cart = getCart();
        const totalPrice = product.price + delivery;
        
        const existingProduct = cart.find(item => item.id === product.id);
        
        if (existingProduct) {
            existingProduct.quantity += 1;
        } else {
            cart.push({
                id: product.id,
                title: product.title,
                price: totalPrice,
                basePrice: product.price,
                deliveryPrice: delivery,
                image: product.image,
                quantity: 1
            });
        }
        
        saveCart(cart);
        return cart;
    }

    const addToCartBtn = document.getElementById('addToCart');
    const cartButtonText = document.getElementById('cartButtonText');

    addToCartBtn.addEventListener('click', function() {
        const cart = addToCart(productData, deliveryPrice);
        
        this.classList.add('added');
        cartButtonText.innerHTML = '‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É';
        this.disabled = true;
        
        setTimeout(() => {
            this.classList.remove('added');
            cartButtonText.innerHTML = '–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É';
            this.disabled = false;
        }, 2000);
        
        console.log('–ö–æ—Ä–∑–∏–Ω–∞:', cart);
    });

    // ============================================
    // WISHLIST
    // ============================================
    
    const wishlistBtn = document.getElementById('wishlist');
    
    wishlistBtn.addEventListener('click', function() {
        this.classList.toggle('active');
        this.innerHTML = this.classList.contains('active') ? '‚ô•' : '‚ô°';
    });

    // ============================================
    // RATING STARS
    // ============================================
    
    const starBtns = document.querySelectorAll('.star-btn');
    const ratingValue = document.getElementById('ratingValue');
    
    starBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const rating = parseInt(this.dataset.rating);
            ratingValue.value = rating;
            
            starBtns.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        });
    });

    // Set default rating
    starBtns.forEach(star => star.classList.add('active'));

    // ============================================
    // REVIEW FORM SUBMISSION
    // ============================================
    
    const reviewForm = document.getElementById('reviewForm');
    const reviewsList = document.getElementById('reviewsList');
    
    reviewForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const userName = document.getElementById('userName').value;
        const rating = parseInt(document.getElementById('ratingValue').value);
        const reviewText = document.getElementById('reviewText').value;
        
        // Create review card
        const reviewCard = document.createElement('div');
        reviewCard.className = 'review-card';
        
        const stars = '‚òÖ'.repeat(rating) + '‚òÜ'.repeat(5 - rating);
        const currentDate = new Date().toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' });
        
        reviewCard.innerHTML = `
            <div class="review-header">
                <div>
                    <div class="reviewer-name">${userName}</div>
                    <div class="stars" style="font-size: 14px;">${stars}</div>
                </div>
                <div class="review-date">${currentDate}</div>
            </div>
            <div class="review-text">${reviewText}</div>
        `;
        
        // Check if "no reviews" message exists
        const noReviewsMsg = reviewsList.querySelector('p');
        if (noReviewsMsg) {
            noReviewsMsg.remove();
        }
        
        // Add to top of reviews list
        reviewsList.insertBefore(reviewCard, reviewsList.firstChild);
        
        // Reset form
        reviewForm.reset();
        starBtns.forEach(star => star.classList.add('active'));
        ratingValue.value = 5;
        
        // Show success message
        alert('–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤!');
    });
</script>

</body>
</html>